train<-read.csv("H:\\data science\\data science\\case 3\\train.csv",header=T,sep=",",na.strings=c(""))
test<-read.csv("H:\\data science\\data science\\case 3\\test.csv",header=T,sep=",",na.strings=c(""))
summary(train)
str(train)
train$Gender<-ifelse(is.na(train$Gender),2,train$Gender)
sum(is.na(train$Gender))
train$Married<-ifelse (is.na(train$Married),2,train$Married)
sum(is.na(train$Married))
train$Dependents<-ifelse(is.na(train$Dependents),0,train$Dependents)
sum(is.na(train$Dependents))
train$Self_Employed<-ifelse(is.na(train$Self_Employed),1,train$Self_Employed)
sum(is.na(train$Self_Employed))
train$LoanAmount<-ifelse(is.na(train$LoanAmount),median(train$LoanAmount,na.rm=T),train$LoanAmount)
sum(is.na(train$LoanAmount))
train$Loan_Amount_Term<-ifelse(is.na(train$Loan_Amount_Term),median(train$Loan_Amount_Term,na.rm = T),train$Loan_Amount_Term)
sum(is.na(train$Loan_Amount_Term))
train$Credit_History<-ifelse(is.na(train$Credit_History),median(train$Credit_History,na.rm = T),train$Credit_History)
sum(is.na(train$Credit_History))
#analysis
names(train)
model<-glm(Loan_Status~Property_Area+Credit_History+Loan_Amount_Term+LoanAmount+CoapplicantIncome+ApplicantIncome+Self_Employed+
             Education+Dependents+Married+Gender,family = 'binomial',data = train)
summary(model)
train$preds<- predict(model,train,type = 'response')
train$outcome<-ifelse(train$preds>=.5,1,0)
table(train$Loan_Status,train$outcome)
####rf##
install.packages('randomForest')
library(randomForest)
model_rf<-randomForest(Loan_Status~Property_Area+Credit_History+Loan_Amount_Term+LoanAmount+CoapplicantIncome+ApplicantIncome+Self_Employed+
                         Education+Dependents+Married+Gender,data = train)
summary(model_rf)
train$preds<- predict(model_rf,train,type = 'response')
table(train$Loan_Status,train$preds)

#test###
str(test)
summary(test)
test$Gender<-ifelse (is.na (test$Gender),2,test$Gender)
sum(is.na(test$Gender))
test$Dependents<-ifelse(is.na(test$Dependents),0,test$Dependents)
sum(is.na(test$Dependents))
test$Self_Employed<-ifelse(is.na(test$Self_Employed),1,test$Self_Employed)
sum(is.na(test$Self_Employed))
test$LoanAmount<-ifelse(is.na(test$LoanAmount),median(test$LoanAmount,na.rm=T),test$LoanAmount)
sum(is.na(test$LoanAmount))
test$Loan_Amount_Term<-ifelse(is.na(test$Loan_Amount_Term),median(test$Loan_Amount_Term,na.rm = T),test$Loan_Amount_Term)
sum(is.na(test$Loan_Amount_Term))
test$Credit_History<-ifelse(is.na(test$Credit_History),median(test$Credit_History,na.rm = T),test$Credit_History)
sum(is.na(test$Credit_History))
summary(test)
str(test)
test$Married<- ifelse(test$Married=='Yes',1,2)


####rf##

test$preds<- predict(model_rf,test,type = 'response')
test$outcome<-ifelse(test$preds== 'Yes',1,0)
write.csv(test,'finalpredsloanpre.csv')
getwd()
